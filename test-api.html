<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API í‚¤ í…ŒìŠ¤íŠ¸</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; }
        .container { max-width: 600px; margin: 0 auto; }
        input { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; }
        button { background: #3b82f6; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background: #2563eb; }
        .result { margin-top: 20px; padding: 15px; border-radius: 4px; }
        .success { background: #d1fae5; border: 1px solid #10b981; color: #065f46; }
        .error { background: #fee2e2; border: 1px solid #ef4444; color: #991b1b; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”‘ Gemini API í‚¤ í…ŒìŠ¤íŠ¸</h1>
        <p>Google AI Studioì—ì„œ ë°œê¸‰ë°›ì€ Gemini API í‚¤ë¥¼ ì…ë ¥í•˜ì—¬ ì—°ê²°ì„ í…ŒìŠ¤íŠ¸í•˜ì„¸ìš”.</p>
        
        <input type="password" id="apiKey" placeholder="API í‚¤ë¥¼ ì…ë ¥í•˜ì„¸ìš” (AIë¡œ ì‹œì‘í•˜ëŠ” ê¸´ ë¬¸ìì—´)">
        <button onclick="testConnection()">ì—°ê²° í…ŒìŠ¤íŠ¸</button>
        
        <div id="result"></div>
        
        <h2>ğŸ“‹ ì‚¬ìš©ë²•</h2>
        <ol>
            <li><a href="https://aistudio.google.com/" target="_blank">Google AI Studio</a>ì—ì„œ API í‚¤ë¥¼ ë°œê¸‰ë°›ìœ¼ì„¸ìš”</li>
            <li>ìœ„ ì…ë ¥ í•„ë“œì— API í‚¤ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”</li>
            <li>"ì—°ê²° í…ŒìŠ¤íŠ¸" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”</li>
            <li>ì„±ê³µí•˜ë©´ ë©”ì¸ ì•±ì—ì„œ ê°™ì€ API í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
        </ol>
        
        <h2>ğŸ”— ë©”ì¸ ì•±ìœ¼ë¡œ ì´ë™</h2>
        <p><a href="index.html">AI ClassNote</a>ë¡œ ì´ë™í•˜ì—¬ ì‹¤ì œ ê¸°ëŠ¥ì„ ì‚¬ìš©í•´ë³´ì„¸ìš”.</p>
    </div>

    <script>
        async function testConnection() {
            const apiKey = document.getElementById('apiKey').value.trim();
            const resultDiv = document.getElementById('result');
            
            if (!apiKey) {
                showResult('API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
                return;
            }
            
            if (!apiKey.startsWith('AI')) {
                showResult('ì˜¬ë°”ë¥¸ Gemini API í‚¤ í˜•ì‹ì´ ì•„ë‹™ë‹ˆë‹¤. API í‚¤ëŠ” "AI"ë¡œ ì‹œì‘í•´ì•¼ í•©ë‹ˆë‹¤.', 'error');
                return;
            }
            
            showResult('ì—°ê²° í…ŒìŠ¤íŠ¸ ì¤‘...', 'info');
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: "ì•ˆë…•í•˜ì„¸ìš”. ì—°ê²° í…ŒìŠ¤íŠ¸ì…ë‹ˆë‹¤. ê°„ë‹¨í•œ ì‘ë‹µì„ í•´ì£¼ì„¸ìš”."
                            }]
                        }]
                    })
                });

                if (response.ok) {
                    const data = await response.json();
                    if (data.candidates && data.candidates[0] && data.candidates[0].content) {
                        const responseText = data.candidates[0].content.parts[0].text;
                        showResult(`âœ… ì—°ê²° ì„±ê³µ!<br><br>AI ì‘ë‹µ: "${responseText}"<br><br>ì´ì œ ë©”ì¸ ì•±ì—ì„œ ì´ API í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.`, 'success');
                        
                        // ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ì— API í‚¤ ì €ì¥
                        sessionStorage.setItem('gemini_api_key', apiKey);
                    } else {
                        showResult('âŒ API ì‘ë‹µ í˜•ì‹ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
                    }
                } else {
                    const errorData = await response.json();
                    let errorMessage = `âŒ ì—°ê²° ì‹¤íŒ¨ (${response.status})`;
                    
                    if (errorData.error) {
                        switch (errorData.error.code) {
                            case 400:
                                errorMessage += '<br>API í‚¤ê°€ ìœ íš¨í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.';
                                break;
                            case 403:
                                errorMessage += '<br>API ì ‘ê·¼ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.';
                                break;
                            case 429:
                                errorMessage += '<br>API ì‚¬ìš©ëŸ‰ì´ ì´ˆê³¼ë˜ì—ˆìŠµë‹ˆë‹¤.';
                                break;
                            default:
                                errorMessage += `<br>${errorData.error.message || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}`;
                        }
                    }
                    
                    showResult(errorMessage, 'error');
                }
            } catch (error) {
                showResult(`âŒ ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${error.message}`, 'error');
            }
        }
        
        function showResult(message, type) {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = message;
            resultDiv.className = `result ${type}`;
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ API í‚¤ ë³µì›
        window.addEventListener('load', () => {
            const savedKey = sessionStorage.getItem('gemini_api_key');
            if (savedKey) {
                document.getElementById('apiKey').value = savedKey;
            }
        });
    </script>
</body>
</html>
